#!/bin/bash

###### Aligning RNA-seq reads using STAR ##### 
# Make sample directories for Unstimulated and LPS conditions
mkdir D1_LPS D2_LPS D3_LPS D4_LPS
mkdir D1_unstim D2_unstim D3_unstim D4_unstim

#D1_LPS (1/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D1_LPS_1.fastq.gz D1_LPS_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D1_LPS/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000 

#D2_LPS (2/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D2_LPS_1.fastq.gz D2_LPS_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D2_LPS/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000

#D3_LPS (3/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D3_LPS_1.fastq.gz D3_LPS_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D3_LPS/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000

#D4_LPS (4/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D4_LPS_1.fastq.gz D4_LPS_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D4_LPS/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000

#D1_unstim (5/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D1_unstim_1.fastq.gz D1_unstim_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D1_unstim/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000 

#D2_unstim (6/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D2_unstim_1.fastq.gz D2_unstim_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D2_unstim/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000

#D3_unstim (7/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D3_unstim_1.fastq.gz D3_unstim_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D3_unstim/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000

#D4_unstim (8/8 conditions) 
STAR \
--genomeDir /datasets/resources/genomes/human/GRCh38_STAR_index \
--readFilesIn D4_unstim_1.fastq.gz D4_unstim_2.fastq.gz \
--readFilesCommand zcat \
--outFileNamePrefix /work/alignIntronMax_500000/D4_unstim/ \
--outSAMtype BAM SortedByCoordinate \
--runThreadN 8 \
--quantMode GeneCounts \
--alignIntronMax 500000